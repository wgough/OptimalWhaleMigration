---
title: "Baleen Whale Migration Speeds Optimize Year-round Energetic Budgets"
author: William T. Gough$^{1,2}$, Max F. Czapanskiy$^{1,3,4}$, Daniel M. Palacios$^{5,6}$, Matthew S. Savoca$^{1}$, James Fahlbusch$^{1,7}$, William K. Oestreich$^{1,8}$, Elliott L. Hazen$^{9}$, Lars Bejder$^{2}$, John Calambokidis$^{7}$, Jeremy A. Goldbogen$^{1}$
bibliography: ZoteroLibraryGough.json
csl: functional-ecology.csl
output:
  word_document: default
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Libraries, include=FALSE}
library(tidyverse)
library(ggplot2)
library(cowplot)
library(dplyr)
library(knitr)
library(tinytex)
library(rbbt)
library(ggspatial)
library(grid)
library(gridExtra)
library(pdftools)
library(magick)
library(PieGlyph)
library(purrr)
library(formatdown)
library(broom)
library(devtools)

load_all()
```

```{r Literature Review Import, echo=FALSE, include=FALSE}
load("data/MigrationDistancesLit.rda")

MigrationDistancesLit <- MigrationDistancesLit %>% 
  filter(Complete == "Y")

MigrationDistancesLit <- MigrationDistancesLit %>% 
  filter(Species %in% c("Humpback", "Blue")) 

DistancePercentile <- MigrationDistancesLit %>% 
  filter(Species %in% c("Humpback", "Blue")) %>% 
  summarise(Percentile95 = quantile(Migration_Distance_km, probs = 0.95)) %>% 
  pull(Percentile95)

SpeedAvgsAndSEs <- MigrationDistancesLit %>% 
  filter(Species %in% c("Humpback", "Blue")) %>% 
  group_by(Species) %>%
  summarise(AverageSpeed = mean(Migration_Speed_m_s),
            SpeedSE = sd(Migration_Speed_m_s) / sqrt(n()))

MigrationDistancesLitAvgs <- MigrationDistancesLit %>% 
  filter(Complete == "Y") %>% 
  group_by(Source, Species, Migratory_Route_Simple, Direction_of_Travel) %>% 
  summarize(Migration_Distance_km = mean(Migration_Distance_km),
            Migration_Duration_days = mean(Migration_Duration_days),
            Migration_Speed_m_s = mean(Migration_Speed_m_s),
            Number_of_Observations = n(),
            .groups = 'drop')
```

```{r FUNCTION - Convert PDF to PNG, include=FALSE}
convert_pdf_to_png <- function(pdf_file, png_file, dpi = 300) {
  image <- image_read_pdf(pdf_file)
  image_write(image, path = png_file, density = dpi)
}
```

```{r FUNCTION - Linear Relationship Equation, include=FALSE}
Linear_Relationship <- function(x, y) {
  m <- lm(y ~ x)
  coef_a <- format(coef(m)[1], digits = 4)
  coef_b <- format(coef(m)[2], digits = 4)
  r2 <- format(summary(m)$r.squared, digits = 3)
  
  equation <- paste("y =", coef_a, "+", coef_b, "* x, R^2 =", r2)
  
  as.character(equation)
}

Linear_Relationship2 <- function(x, y) {
  m <- lm(y ~ x)
  coef_a <- format(coef(m)[1], digits = 4)
  coef_b <- format(coef(m)[2], digits = 4)
  
  equation <- paste("y =", coef_a, "+", coef_b, "* x")
  
  as.character(equation)
}
```

```{r FUNCTION - Energetic Model, include=FALSE}

#From Savoca - Update DaysSpentFeeding to be 0.5 (half) of the day spent on the feeding ground - important distinction. And Percent Intake per lunge can be 0.3 as a midpoint (similar to Videsen paper), with 0.1 and 0.5 as good and bad years.
energy_model <- function(MigrationSwimSpeeds_ms, BreedingDays, MigrationDistance_km, BodyLength_m, LungesPerDay, PercentDaysSpentFeeding, PercentIntakePerLunge, PercentFluking, Species) {
  
  # Daily BMR Energy Expenditure (Kleiber Metabolic Rate Equation From Gough et al. 2022)
  if (Species == "Humpback"){
    BodyMassFromShirel_kg = 10^(2.3373*(log10(BodyLength_m))+1.8535)
  } else if (Species == "Blue"){
    BodyMassFromShirel_kg = 10^(3.3346*(log10(BodyLength_m))+0.3129)
  }
  DailyBMREnergyExpenditure = OptimalWhaleMigration::pred_mr(mass_kg = BodyMassFromShirel_kg, 
                                                        mr_method = "kleiber", unit = "kJ_day")
  
  # Efficiency Values
  MetEff = 0.25
  PropEff = 0.90
  
  # Annual Time Budget
  FeedingSwimSpeeds_ms = 2
  OverGroundSpeeds_ms = MigrationSwimSpeeds_ms / 2
  OverGroundSpeeds_km_day = (OverGroundSpeeds_ms / 1000) * 86400
  MigratoryDays = MigrationDistance_km / OverGroundSpeeds_km_day
  FeedingGroundDays <- pmax(365 - BreedingDays - MigratoryDays * 2, 0)
  DaysSpentFeeding <- FeedingGroundDays * PercentDaysSpentFeeding
  
  # Swimming Energetics
  ThrustPower_Feeding_W_kg = 10^(0.381*(FeedingSwimSpeeds_ms)-1.215)
  ThrustPower_Migration_W_kg = 10^(0.381*(MigrationSwimSpeeds_ms)-1.215)
  ECostSwim_Feeding_kJ_s = ((ThrustPower_Feeding_W_kg*BodyMassFromShirel_kg) / (MetEff*PropEff)) / 1000
  ECostSwim_Migration_kJ_s = ((ThrustPower_Migration_W_kg*BodyMassFromShirel_kg) / (MetEff*PropEff)) / 1000
  
  
  # Swimming + Metabolic Costs Per Day
  ECostSwimAndBMR_Feeding_kJ_Day = (ECostSwim_Feeding_kJ_s*(86400*PercentFluking)) + (DailyBMREnergyExpenditure)
  ECostSwimAndBMR_Migration_kJ_Day = (ECostSwim_Migration_kJ_s*(86400*PercentFluking)) + (DailyBMREnergyExpenditure)
  
  # Feeding Season Energetics UPDATE HERE
  ECostLunge <- function(BodyLength_m){
    10^((2.07*log10(BodyLength_m))+0.83)
  }
  EIntakeLunge <- function(BodyLength_m){
    10^((2.86*log10(BodyLength_m))+1.48)
  }
  LungesPerSeason = DaysSpentFeeding * LungesPerDay
  EIntakeFeedSeason_kJ = LungesPerSeason * EIntakeLunge(BodyLength_m) * PercentIntakePerLunge
  ECostFeedSeason_kJ = FeedingGroundDays * ECostSwimAndBMR_Feeding_kJ_Day + LungesPerSeason * ECostLunge(BodyLength_m)
  ENetFeedSeason_kJ = EIntakeFeedSeason_kJ - ECostFeedSeason_kJ
  
  # Migratory Route Energetics
  ECostMigration_kJ = ECostSwimAndBMR_Migration_kJ_Day * MigratoryDays
  
  # Total Annual Energetics
  ERatioMigrationFeed = ECostMigration_kJ / ENetFeedSeason_kJ
  EPercentMigrationFeed = ERatioMigrationFeed * 100
  
  return(list(OverGroundSpeeds_ms = OverGroundSpeeds_ms,
              ECostSwimAndBMR_Feeding_kJ_Day = ECostSwimAndBMR_Feeding_kJ_Day,
              ECostSwimAndBMR_Migration_kJ_Day = ECostSwimAndBMR_Migration_kJ_Day,
              ECostLunge = ECostLunge(BodyLength_m),
              EIntakeLunge = EIntakeLunge(BodyLength_m),
              ENetFeedSeason_kJ = ENetFeedSeason_kJ,
              ECostMigration_kJ = ECostMigration_kJ,
              ERatioMigrationFeed = ERatioMigrationFeed,
              EPercentMigrationFeed = EPercentMigrationFeed,
              BreedingDays = BreedingDays,
              MigratoryDays = MigratoryDays,
              FeedingGroundDays = FeedingGroundDays))
}
```

```{r Create Blue and Humpback Dataframes, include=FALSE}
modifier <- c(0.8, 0.85, 0.9, 0.95, 1, 1.05, 1.1, 1.15, 1.2)

dataframe_humpback = expand_grid(MigrationSwimSpeeds_ms = seq(1, 4, by = 0.1),
                                 BreedingDays = 50 * modifier,
                                 MigrationDistance_km = seq(2000, 12000, by = 2000),
                                 BodyLength_m = 12 * modifier,
                                 LungesPerDay = 546 * modifier,
                                 PercentDaysSpentFeeding = 0.5,
                                 PercentIntakePerLunge = c(0.3, 0.5, 0.7),
                                 PercentFluking = 0.55 * modifier) %>% 
  mutate(model_results = pmap(
    .l = list(MigrationSwimSpeeds_ms, BreedingDays, MigrationDistance_km, BodyLength_m, LungesPerDay, PercentDaysSpentFeeding, PercentIntakePerLunge, PercentFluking, Species = "Humpback"),
    .f = energy_model),
    OverGroundSpeeds_ms = map_dbl(model_results, "OverGroundSpeeds_ms"),
    ECostSwimAndBMR_Feeding_kJ_Day = map_dbl(model_results, "ECostSwimAndBMR_Feeding_kJ_Day"),
    ECostSwimAndBMR_Migration_kJ_Day = map_dbl(model_results, "ECostSwimAndBMR_Migration_kJ_Day"),
    ECostLunge = map_dbl(model_results, "ECostLunge"),
    EIntakeLunge = map_dbl(model_results, "EIntakeLunge"),
    ENetFeedSeason_kJ = map_dbl(model_results, "ENetFeedSeason_kJ"),
    ECostMigration_kJ = map_dbl(model_results, "ECostMigration_kJ"),
    ERatioMigrationFeed = map_dbl(model_results, "ERatioMigrationFeed"),
    EPercentMigrationFeed = map_dbl(model_results, "EPercentMigrationFeed"),
    BreedingDays = map_dbl(model_results, "BreedingDays"),
    MigratoryDays = map_dbl(model_results, "MigratoryDays"),
    FeedingGroundDays = map_dbl(model_results, "FeedingGroundDays"),
    Species = "Humpback"
  )

dataframe_blue = expand_grid(MigrationSwimSpeeds_ms = seq(1, 4, by = 0.1),
                             BreedingDays = 50 * modifier,
                             MigrationDistance_km = seq(2000, 12000, by = 2000),
                             BodyLength_m = 22 * modifier,
                             LungesPerDay = 204 * modifier,
                             PercentDaysSpentFeeding = 0.5,
                             PercentIntakePerLunge = c(0.3, 0.5, 0.7),
                             PercentFluking = 0.35 * modifier) %>% 
  mutate(model_results = pmap(
    .l = list(MigrationSwimSpeeds_ms, BreedingDays, MigrationDistance_km, BodyLength_m, LungesPerDay, PercentDaysSpentFeeding, PercentIntakePerLunge, PercentFluking, Species = "Blue"),
    .f = energy_model),
    OverGroundSpeeds_ms = map_dbl(model_results, "OverGroundSpeeds_ms"),
    ECostSwimAndBMR_Feeding_kJ_Day = map_dbl(model_results, "ECostSwimAndBMR_Feeding_kJ_Day"),
    ECostSwimAndBMR_Migration_kJ_Day = map_dbl(model_results, "ECostSwimAndBMR_Migration_kJ_Day"),
    ECostLunge = map_dbl(model_results, "ECostLunge"),
    EIntakeLunge = map_dbl(model_results, "EIntakeLunge"),
    ENetFeedSeason_kJ = map_dbl(model_results, "ENetFeedSeason_kJ"),
    ECostMigration_kJ = map_dbl(model_results, "ECostMigration_kJ"),
    ERatioMigrationFeed = map_dbl(model_results, "ERatioMigrationFeed"),
    EPercentMigrationFeed = map_dbl(model_results, "EPercentMigrationFeed"),
    BreedingDays = map_dbl(model_results, "BreedingDays"),
    MigratoryDays = map_dbl(model_results, "MigratoryDays"),
    FeedingGroundDays = map_dbl(model_results, "FeedingGroundDays"),
    Species = "Blue"
  )

dataframe_combined <- rbind(dataframe_humpback, dataframe_blue)
```

```{r Create Sampling Distributions For Figure 2, include=FALSE}
bootstrap_sampling <- function(data, n_samples = 10000) {
  data %>%
    filter(!is.na(EPercentMigrationFeed)) %>%
    group_by(MigrationDistance_km) %>%
    summarise(Sampling_Distribution = list(
      if (n() > 0) {
        as.vector(unlist(replicate(n_samples, sample(EPercentMigrationFeed, replace = TRUE))))
      } else {
        numeric(0)
      }
    )) %>%
    unnest(cols = c(Sampling_Distribution), keep_empty = TRUE)
}

combined_sampling <- bind_rows(
  bootstrap_sampling(dataframe_blue, "Blue Whale"),
  bootstrap_sampling(dataframe_humpback, "Humpback Whale")
)
```

```{r Create Useful Dataframes For Figure 3, include=FALSE}
speed_averaged_dataframe <- dataframe_combined %>%
  filter(!is.infinite(EPercentMigrationFeed)) %>%
  group_by(OverGroundSpeeds_ms, MigrationDistance_km) %>%
  summarise(MeanRatio = mean(log10(ERatioMigrationFeed)))

Min_Ratios <- speed_averaged_dataframe %>%
  group_by(MigrationDistance_km) %>%
  summarise(MinRatio = min(MeanRatio))

Opt_Speeds <- speed_averaged_dataframe %>%
  inner_join(Min_Ratios, by = c("MigrationDistance_km", "MeanRatio" = "MinRatio")) %>%
  select(MigrationDistance_km, OptSpeed = OverGroundSpeeds_ms)

time_chunk_dataframe <- dataframe_combined %>% 
  filter(!is.infinite(EPercentMigrationFeed)) %>% 
  group_by(MigrationDistance_km) %>% 
  summarise(Mean_MigratoryDaysEquator = mean(MigratoryDays)/2,
            Mean_BreedingDays = mean(BreedingDays),
            Mean_MigratoryDaysPolar = mean(MigratoryDays)/2,
            Mean_FeedingGroundDays = mean(FeedingGroundDays)) %>% 
  pivot_longer(Mean_MigratoryDaysEquator:Mean_FeedingGroundDays, names_to = "TimeSlice", values_to = "Days") %>% 
  left_join(Min_Ratios, by = "MigrationDistance_km") %>%
  left_join(Opt_Speeds, by = "MigrationDistance_km")
```

``` {r Linear Regression Model Comparisons and Migration Direction t-tests, include=FALSE}
regressions_data <- data.frame(
  Distance = c(MigrationDistancesLitAvgs$Migration_Distance_km, Opt_Speeds$MigrationDistance_km),
  Speed = c(MigrationDistancesLitAvgs$Migration_Speed_m_s, Opt_Speeds$OptSpeed),
  Group = rep(c("Literature", "Optimal"), 
              c(nrow(MigrationDistancesLitAvgs), nrow(Opt_Speeds))))

ancova_model <- lm(Speed ~ Distance * Group, data = regressions_data)

ModelCompareStats <- glance(ancova_model)

# Shapiro-Wilk normality test for migration distance
shapiro.test(MigrationDistancesLitAvgs$Migration_Distance_km[MigrationDistancesLitAvgs$Direction_of_Travel == "Equatorward"])
shapiro.test(MigrationDistancesLitAvgs$Migration_Distance_km[MigrationDistancesLitAvgs$Direction_of_Travel == "Poleward"])

# Shapiro-Wilk normality test for migration speed
shapiro.test(MigrationDistancesLitAvgs$Migration_Speed_m_s[MigrationDistancesLitAvgs$Direction_of_Travel == "Equatorward"])
shapiro.test(MigrationDistancesLitAvgs$Migration_Speed_m_s[MigrationDistancesLitAvgs$Direction_of_Travel == "Poleward"])

# Perform t-test for migration distance (equatorward vs. poleward)
t_test_MigrationDistance_Direction <- t.test(MigrationDistancesLitAvgs$Migration_Distance_km[MigrationDistancesLitAvgs$Direction_of_Travel == "Equatorward"], MigrationDistancesLitAvgs$Migration_Distance_km[MigrationDistancesLitAvgs$Direction_of_Travel == "Poleward"], 
                       alternative = "two.sided", na.rm = TRUE)

# Perform t-test for migration speed (equatorward vs. poleward)
t_test_MigrationSpeed_Direction <- t.test(MigrationDistancesLitAvgs$Migration_Speed_m_s[MigrationDistancesLitAvgs$Direction_of_Travel == "Equatorward"], MigrationDistancesLitAvgs$Migration_Speed_m_s[MigrationDistancesLitAvgs$Direction_of_Travel == "Poleward"], 
                       alternative = "two.sided", na.rm = TRUE)

# Print the results
t_test_MigrationDistance_Direction
t_test_MigrationSpeed_Direction

t_test_DistanceStats <- glance(t_test_MigrationDistance_Direction)

t_test_SpeedStats <- glance(t_test_MigrationSpeed_Direction)
```

```{r Figure 2 - MigrationEnergeticPercentages, echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.keep='none', fig.align='center', fig.dim = c(8, 8)}
pal <- c("Humpback" = "#58084F", "Blue" = "#258d12")

pMEP <- ggplot(dataframe_combined) +
  geom_rug(data = MigrationDistancesLit, aes(x = Migration_Distance_km*2, color = Species), sides = "b", size = 3)+
  geom_boxplot(aes(x=MigrationDistance_km*2, y=EPercentMigrationFeed, fill=Species, group = interaction(Species, MigrationDistance_km)), size = 3, outlier.shape = NA, position = position_dodge(width = 3200)) +
  geom_vline(xintercept = DistancePercentile*2, linetype = "dotted", size = 5) +
  annotate("text", x=17600, y=118, label="95% Percentile of Distance", size = 16, angle="90") +
  coord_cartesian(xlim = c(3000,25000), ylim = c(0,120), expand = TRUE) +
  scale_x_continuous(breaks = seq(4000, 24000, by = 4000)) +
  scale_y_continuous(breaks = seq(0, 120, by = 5)) +
  scale_color_manual(values = pal) +
  scale_fill_manual(values = pal) +
  labs(x = "Annual Migration Distance Covered (km)",
       y = "Full-Year Migration-Related Costs (% of Annual Intake)") +
  guides(alpha = "none", 
         fill = "none",
         color = guide_legend(keywidth = 5, 
                              keyheight = 4, 
                              override.aes=list(fill=NA), 
                              title = "Species")) +
  theme_classic(base_size = 8) +
  theme(axis.text = element_text(size = 48),
        axis.title.x = element_text(size = 60, margin = margin(t = 30, r = 0, b = 0, l = 0)),
        axis.title.y = element_text(size = 60, margin = margin(t = 0, r = 60, b = 0, l = 0)),
        axis.line = element_line(color = "black", size = 1),
        legend.position = c(0.1, 0.9),
        legend.title = element_text(size = 52),
        legend.text = element_text(size = 48),
        panel.grid.minor = element_blank())

ggsave("figs/MigrationPercentagesNew.pdf", height = 720, width = 960, units = "mm", dpi = 300)

convert_pdf_to_png("figs/MigrationPercentagesNew.pdf", "figs/MigrationPercentagesNew.png", dpi = 300)
```

```{r Figure 3 - SpeedCurves, echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.keep='none', fig.align='center', fig.dim = c(8, 8)}
# Define the original palette with the correct color mapping
pal <- c("Mean_FeedingGroundDays" = "#305496", 
         "Mean_MigratoryDaysEquator" = "#f3b284", 
         "Mean_MigratoryDaysPolar" = "#f3b284", 
         "Mean_BreedingDays" = "#D3D3D3")

# Update the plot
pSC <- ggplot(speed_averaged_dataframe) +
  geom_vline(xintercept = 2.09/2, linetype = 2, size = 2, colour = "#58084F") +
  annotate("text", x=2.09/2+0.02, y=0.40, label="Humpback", size = 14, angle = 270, color = "#58084F", hjust=0) +
  geom_vline(xintercept = 2.20/2, linetype = 2, size = 2, colour = "#258d12") +
  annotate("text", x=2.20/2+0.02, y=0.40, label="Blue", size = 14, angle = 270, color = "#258d12", hjust=0) +
  geom_line(aes(OverGroundSpeeds_ms, MeanRatio, group = factor(MigrationDistance_km), color = factor(MigrationDistance_km)), size = 3) +
  geom_segment(data=time_chunk_dataframe, aes(x = OptSpeed,
                   xend = OptSpeed,
                   y = MinRatio-0.25,
                   yend = MinRatio+0.25),
               size = 4) +
  geom_pie_glyph(data=time_chunk_dataframe, 
                 aes(x=OptSpeed, y=MinRatio, fill=TimeSlice), 
                 slices = 'TimeSlice', values = 'Days', colour = 'black', radius = 2.5) +
  annotate("text", x=0.51, y=-1.833, label="2000km", size = 16) +
  annotate("text", x=0.51, y=-1.298, label="4000km", size = 16) +
  annotate("text", x=0.51, y=-0.568, label="6000km", size = 16) +
  annotate("text", x=0.615, y=0.234, label="8000km", size = 16) +
  annotate("text", x=0.76, y=0.304, label="10000km", size = 16) +
  annotate("text", x=0.91, y=0.375, label="12000km", size = 16) +
  coord_cartesian(ylim = c(-2.5,0.35)) +
  scale_color_manual(values = c("Humpback" = "#58084F", "Blue" = "#258d12")) +
  scale_fill_manual(values = pal, 
                    labels = c("Feeding Days", "Migratory Days", "Breeding Days"),
                    breaks = c("Mean_FeedingGroundDays", "Mean_MigratoryDaysEquator", "Mean_BreedingDays")) +
  labs(x = bquote("Over-Ground Migration Speed (m s"^-1*")"),
       y = bquote(Log[10]* " Migration Cost / Net Foraging Season Intake")) +
  guides(alpha = "none", 
         color = "none",
         fill = guide_legend(keywidth = 5, 
                              keyheight = 4, 
                              override.aes=list(color=NA), 
                              title = "Segments of Annual Cycle")) +
  theme_classic(base_size = 8) +
  theme(axis.text = element_text(size = 48),
        axis.title = element_text(size = 60),
        axis.line = element_line(color = "black", size = 1),
        legend.position = c(0.13, 0.08),
        legend.title = element_text(size = 52),
        legend.text = element_text(size = 48),
        panel.grid.minor = element_blank())

ggsave("figs/SpeedCurvesNew.pdf", height = 720, width = 960, units = "mm", dpi = 300)

convert_pdf_to_png("figs/SpeedCurvesNew.pdf", "figs/SpeedCurvesNew.png", dpi = 300)

```

```{r Figure 4 - DistanceVersusSpeed, echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.keep='none', fig.align='center', fig.dim = c(8, 8)}
pal <- c("Humpback" = "#58084F", "Blue" = "#258E12")

pLMSC <- ggplot(Opt_Speeds, aes(MigrationDistance_km, OptSpeed)) +
  geom_smooth(method = lm, colour = "black", fullrange=TRUE, size = 3, se=FALSE) +
  geom_smooth(data = MigrationDistancesLitAvgs, aes(Migration_Distance_km, Migration_Speed_m_s), method = lm, colour = "darkgrey", linetype = "dashed", fullrange=TRUE, size = 3) +
  geom_point(data = MigrationDistancesLitAvgs, aes(Migration_Distance_km, Migration_Speed_m_s, fill = Species, size = Number_of_Observations, shape = Direction_of_Travel)) +
  geom_segment(aes(x = 8500, xend = 8900, y = 0.5, yend = 0.5, fill = "black", linetype = "solid"), size = 2) +
  geom_text(x = 9000, y = 0.4, label = Linear_Relationship2(Opt_Speeds$MigrationDistance_km, Opt_Speeds$OptSpeed), size = 16, hjust = 0) +
  geom_segment(aes(x = 8500, xend = 8900, y = 0.4, yend = 0.4, fill = "darkgrey", linetype = "dashed"), size = 2) +
  geom_text(x = 9000, y = 0.5, label = Linear_Relationship(MigrationDistancesLitAvgs$Migration_Distance_km, MigrationDistancesLitAvgs$Migration_Speed_m_s), size = 16, hjust = 0) +
  coord_cartesian(xlim = c(1500,12500), expand = TRUE) +
  scale_x_continuous(breaks = seq(2000, 12000, by = 2000)) +
  scale_fill_manual(values = pal) +
  scale_color_manual(values = pal) +
  scale_shape_manual(values = c(21,22)) +
  scale_size(range = c(12, 36)) +
  labs(x = "Unidirectional Migration Distance (km)",
       y = bquote("Over-Ground Migration Speed (m s"^-1*")")) +
  guides(size = "none", 
         linetype = "none",
         shape = guide_legend(title = "Direction of Travel", override.aes = list(size = 10)),
         fill = guide_legend(title = "Species", override.aes = list(size = 10, colour = c("#58084F", "#258E12")))) +
  theme_classic(base_size = 8) +
  theme(axis.text = element_text(size = 48),
        axis.title = element_text(size = 60),
        axis.line = element_line(color = "black", size = 1),
        legend.position = c(0.10, 0.85),
        legend.title = element_text(size = 52),
        legend.text = element_text(size = 48),
        panel.grid.minor = element_blank())

ggsave("figs/DistanceVersusSpeedNew.pdf", height = 480, width = 960, units = "mm", dpi = 300)

convert_pdf_to_png("figs/DistanceVersusSpeedNew.pdf", "figs/DistanceVersusSpeedNew.png", dpi = 300)
```

# Affiliations

1)  Hopkins Marine Station, Stanford University, Pacific Grove, CA 93950, USA.
2)  Marine Mammal Research Program, Hawaii Institute of Marine Biology, University of Hawaii, Manoa, Kaneohe, HI 96744, USA.
3)  NOAA Southwest Fisheries Science Center, Fisheries Ecology Division, Santa Cruz, CA 95060, USA.
4)  Ocean Sciences Department, University of California, Santa Cruz, Santa Cruz, CA 95060, USA
5)  Marine Mammal Institute, Oregon State University, Newport, OR 97365, USA
6)  Department of Fisheries, Wildlife, and Conservation Sciences, Oregon State University, Newport, OR 97365, USA
7)  Cascadia Research Collective, Olympia, WA 98501, USA.
8)  Monterey Bay Aquarium Research Institute, Moss Landing, CA 95039, USA
9)  NOAA Southwest Fisheries Science Center, Ecosystem Science Division, Monterey, CA 93940, USA.

Correspondence: [wgough\@hawaii.edu](mailto:wgough@hawaii.edu){.email}

# Abstract

Long-distance animal migrations are energetically demanding behaviors performed for a variety of reasons, with migrants facing a continuum between cost- and time-minimizing strategies [@abrahms_etal19; @alerstam_lindstrom90; @brown_etal23; @kenney_etal20; @lasorte_etal16; @merkle_etal16; @pitman_etal15]. Minimizing expenditure leaves more energy available for other processes (e.g., growth and reproduction), but may result in fewer foraging opportunities. Minimizing time results in longer foraging periods and increased energetic intake, but incurs high movement costs. Optimal migration theory predicts that migrants may optimize their energy budget by adopting an intermediate strategy [@alerstam_lindstrom90]. To test this hypothesis, we modeled the annual energy budgets of baleen whales (Mysticeti), a well-studied group of migratory capital breeders (i.e., species which rely on accumulated energy stores to fuel reproduction) [@drent_daan80; @jonsson97; @stephens_etal09]. Mysticetes undertake ocean-basin scale migrations, so their large body sizes and fast reproductive cycles likely place strong selective pressures to optimize their annual energy budgets [@evans_bearhop22; @goldbogen_etal19; @lockyer07]. Using tag-based estimates of foraging intake and swimming costs, we modeled the energy gained during a variable-duration foraging season and the energy spent during a variable-speed migration [@gough_etal22; @savoca_etal21]. We found optimal migration speeds of approximately 1 m s^-1^ for shorter migration distances (2,000-4,000 km), with longer migrations (up to 12,000 km) requiring higher speeds to minimize transit costs relative to foraging intake. Our model accurately predicted the migration speeds of 67 satellite-tracked mysticetes from three species and 10 migration routes. At optimal swimming speeds, we estimate migration accounts for \<10% of the annual energy budget in most cases. These results demonstrate that time- and energy-minimizing migration strategies are not distinct options, and migrants optimize their annual energy budgets by adopting intermediate strategies.

# Introduction

Animal migration serves an important role in the re-distribution of nutrients, genetic dispersal across population boundaries, and maximization of fitness across a dynamic landscape [@dingle_drake07]. Long-distance migrations can span continents and ocean basins and are one of the most energetically demanding behaviors observed within the animal kingdom. Many species transit thousands of kilometers in search of seasonally variable food resources [@block_etal11; @lasorte_etal16; @merkle_etal16] or to move between spatially distinct foraging and breeding grounds [@kenney_etal20]. The distances traveled during these journeys are often informed by environmental features [@abrahms_etal19; @block_etal11; @oestreich_etal22], but they are also constrained by physiological limitations that must also be overcome through novel adaptation [@weber09].

A common adaptation that aids long migration is large body size and increased energy storage [@burns_bloom20; @hein_etal12], with the exception being powered flight (e.g., insects and songbirds) [@alerstam_etal03a]. Larger animals have lower mass-specific metabolic rates [@glazier05; @kleiber75] and costs of transport [@taylor_etal82; @williams99], resulting in more efficient locomotion over greater distances. Even as mass-specific costs decrease for larger animals, absolute costs increase and must be accounted for with efficient prey capture strategies [@mcnab99; @goldbogen_etal19]. Many of the largest terrestrial species are ruminants that take advantage of seasonal greening for their plant-based diet and a specialized digestive apparatus to increase their energetic surplus [@aikens_etal20; @merkle_etal16]. Large marine species are unable to utilize such stability and predictability in ocean resources (but see Abrahms et al. [-@abrahms_etal19]), instead relying on ephemeral prey patches of fish, krill, or copepods [@carroll_etal21; @goldbogen_etal19].

Many of the largest marine animals, including mysticete (baleen) whales (Mysticeti), whale sharks (*Rhincodon typus*), and oceanic manta rays (*Mobula birostris*), efficiently exploit small, abundant prey species (e.g., schooling fish and crustaceans) by filter feeding on large aggregations [@goldbogen_etal19; @motta_etal10; @paig-tran_etal13]. These large body sizes allow many species to undertake months-long migrations over tens of thousands of kilometers [@corkeron_connor99; @guzman_etal18; @kenney_etal20]. Unlike terrestrial ungulates that forage during the migration, mysticetes are capital breeders, meaning they have a defined feeding season (spring and summer months) and are thought to exhibit relatively little feeding behavior outside the feeding season [@lockyer81]. Thus, mysticetes need to live off these reserves for the rest of the year [@drent_daan80; @jonsson97; @stephens_etal09] (Figure 1). Minimizing the cost of the migration would provide a fitness benefit to these animals, leaving a greater proportion of energy for important functions such as reproduction.

![Figure 1. Schematic of a humpback whale annual cycle (right) with a generic equatorward migration route highlighted (bottom left). The upper left box highlights the variables used to determine the energetic cost and intake of a single day on the foraging ground.](./figs/AnnualCycleSchematic.png)

Recent studies on several mysticete species combining biologging tags with UAS morphometrics and hydrodynamic physical modeling have produced high-resolution estimates of energetic intake and costs for both foraging and swimming [@goldbogen_etal19; @savoca_etal21]. Studies using satellite tags have also produced tracks of mysticete migrations ranging from \~2,000-10,000 km [@felix_guzman14; @kettemer_etal22; @mate_etal99; @mate_etal15; @modest_etal21; @riekkola_etal19]. Using these comprehensive datasets, we have estimated the net energy gained during a foraging season as well as the energy lost to migration across a range of swimming speeds. We hypothesized that mysticetes would migrate at speeds which minimized their migratory cost as a function of foraging season energy intake. In addition, we predicted that animals would attempt to balance the energetic cost of the migration with a need to maximize time spent on the foraging and breeding ground, resulting in longer migrations occurring at higher swimming speeds.

# Materials & Methods

## Data Collection and Model Variables

We included blue (*Balaenoptera musculus*) and humpback (*Megaptera novaeangliae*) whales in our energetic modeling. To generate these models, we combined data from a number of sources and parameterized a set of variables associated with the annual cycle of each species. These data included accelerometer tag data (CATS; Customized Animal Tracking Solutions) and associated UAS-photogrammetry measurements previously outlined and published by Gough et al. [-@gough_etal21; -@gough_etal22] for animals on the feeding grounds, previously published data from two migrating blue whales [@oestreich_etal20], and estimates of residency time on the breeding ground obtained from sightings data (Evans and van Aswegen, pers. comm.).

Previous work by Gough et al. [-@gough_etal19; -@gough_etal21] found the average swimming speed ($U_{\text{swim}}$; m s^-1^) of both blue and humpback whales to be ~2 m s^-1^. The two migrating blue whales in our dataset contained highly accurate GPS-positioning and fine-scale movement data [@oestreich_etal20], allowing us to compare swimming speeds with over-ground speeds (i.e., the "real" time that it takes for an animal to swim from one geographic position to another; $U_{\text{over-ground}}$; m s^-1^). These measurements resulted in a multiplicative factor of 2.0 to convert over-ground speed values into swimming speed values. This allowed us to create a range of swimming (1-4 m s^-1^) and over-ground (0.5-2 m s^-1^) speed values for use in our energetic modeling.

Given the potential for substantial variability in our model, we generated anchored ranges (±20%) for a series of critical variables and performed our calculations for each combination of values. These variables included total body length ($TL_{\text{body}}$; m), the number of feeding lunges performed per day ($N_{\text{lunges}}$; lunges day^-1^), the number of days spent on the breeding ground in a given year ($T_{\text{breed}}$; days), and the percentage of time (in seconds) spent actively swimming (i.e., expending energy to generate propulsive tailbeats) throughout an average day ($\%_{\text{fluke}}$; s). We used our UAS-photogrammetry dataset to anchor body length at 22 m for blue whales and 12 m for humpback whales. For the daily lunge rate, we took a value of 204 lunges day^-1^ for blue whales and 546 lunges day^-1^ for humpack whales from Savoca et al. [-@savoca_etal21]. We estimated the percentage of time spent fluking at 35% (30,240 s) for blue whales and 55% (47,520 s) for humpback whales using our published CATS tag dataset and tailbeat-detection methods outlined by Gough et al. [-@gough_etal19; -@gough_etal21]. In the absence of more reliable estimates for blue whales, we set the amount of time spent on the breeding ground at 50 days for both blue and humpback whales from sighting data of humpback whales in Maui Nui (Evans and van Aswegen, pers. comm.). In order to capture the majority of potential migrations undertaken by large cetaceans, we performed our energetic calculations for unidirectional migration distances ($D_{\text{mig}}$; km) ranging from 2,000-12,000 km.

To validate our model, we compiled satellite tag deployments from multiple literature sources and tag types (Table S1) for blue (n = `r format(as.numeric(nrow(MigrationDistancesLit[MigrationDistancesLit$Species == "Blue", , drop = FALSE]), digits = 0))`) and humpback (n = `r format(as.numeric(nrow(MigrationDistancesLit[MigrationDistancesLit$Species == "Humpback", , drop = FALSE]), digits = 0))`) whales. These deployments covered `r format(as.numeric(nrow(MigrationDistancesLitAvgs), digits = 0))` distinct migration routes, with equatorward (n = `r format(as.numeric(nrow(MigrationDistancesLit[MigrationDistancesLit$Direction_of_Travel == "Equatorward", , drop = FALSE]), digits = 0))`) and poleward (n = `r format(as.numeric(nrow(MigrationDistancesLit[MigrationDistancesLit$Direction_of_Travel == "Poleward", , drop = FALSE]), digits = 0))`) migration routes treated separately. To be included in our dataset, a satellite tag deployment had to include: 1) a complete migration moving in either direction (i.e., from foraging ground to breeding ground or vice-versa), 2) not include any portions of swimming on the foraging or breeding grounds, 3) the overall distance covered by the animal during the migration, and 4) the duration of the migration period ($T_{\text{mig}}$; days). Of the Using this data, we were able to calculate the over-ground speed and, subsequently, the presumed swimming speed of each animal.

## Energetic Modeling and Calculation of Optimal Migration Speed

For capital breeding species such as blue and humpback whales, we expect that the majority of annual energy intake occurs on the feeding ground, while the rest of the year involves energy expenditure on the breeding ground and migration routes. Estimating energetic costs on the breeding ground is difficult, but modeling the interactions between annual energy intake and migration costs allowed us to determine the amount of energy remaining for critical reproductive functions.

We started by estimating the energetic intake from a feeding season ($E_{\text{feed}}$; kJ) of a given length ($T_{\text{feed}}$; days) by subtracting the seasonal energetic costs ($E_{\text{cost.feed}}$; kJ) from the seasonal energetic intake ($E_{\text{intake.feed}}$; kJ). We calculated the length of the feeding season:

$$
T_{\text{feed}} = 365 - T_{\text{breed}} - (T_{\text{mig}}*2) \quad (1)
$$

as the remainder of the annual cycle (365 days) after subtracting the length of the breeding season and the length of the migration: estimated through the interaction of over-ground speed and unidirectional migration distance (multiplied by two to account for the two unidirectional migrations performed in a year). For the energetic intake and cost of the feeding season, we used the following equations:

$$
E_{\text{intake.feed}} = E_{\text{intake.lunge}}*N_{\text{lunges}}*T_{\text{feed}} \quad (2)
$$

$$
E_{\text{cost.feed}} = (E_{\text{cost.lunge}}*N_{\text{lunges}}*T_{\text{feed}})+(E_{\text{cost.met}}*T_{\text{feed}}) \quad (3)
$$

where the intake ($E_{\text{intake.lunge}}$; kJ) and cost ($E_{\text{cost.lunge}}$; kJ) of a lunge were calculated for each species at a given body length using regressions from Gough et al. [-@gough_etal22]. The remaining metabolic costs accumulated throughout a given day ($E_{\text{cost.met}}$; kJ) were estimated from the traditional "Kleiber curve" ($70*{M_{\text{body}}}^{.75}$) [@kleiber75] using body mass ($M_{\text{body}}$; kg) calculated from body length using methods outlined by Kahane-Rapport and Goldbogen [@kahane-rapport_goldbogen18]. We can determine the overall energetic balance of the feeding season using the equation:

$$
E_{\text{feed}} = E_{\text{intake.feed}} - E_{\text{cost.feed}} \quad (4)
$$

To determine the cost of migration ($E_{\text{mig}}$; kJ), we started by estimating the energetic cost of swimming ($E_{\text{cost.swim}}$; kJ s^-1^) for each species at a given body length using the equation:

$$
E_{\text{cost.swim}} = 
(\frac{P_{\text{T}}*M_{\text{body}}}{\eta_{\text{met}}*\eta_{\text{prop}}})
\div 1000 \quad (5)
$$

where $P_{\text{T}}$ is the thrust power output (W kg^-1^) estimated for a given swimming speed with a regression taken from Gough et al. [-@gough_etal21], The metabolic efficiency factor ($\eta_{\text{met}}$) was set at 0.25 to account for the conversion from mechanical to metabolic work (three joules of energy lost as heat for every one joule of thrust generated) [@fish96; @fish_rohr99; @potvin_etal21], and $\eta_{\text{prop}}$ is a propulsive efficiency factor set at 0.90 [@gough_etal21]. To determine the overall cost of the migration for each species, we combined the cost of swimming for the percentage of time in a given day spent actively fluking with metabolic costs using the equation:

$$
E_{\text{mig}} = ((E_{\text{cost.swim}}*\%_{\text{fluke}})+E_{\text{cost.met}})*T_{\text{mig}} \quad (6)
$$

For each combination of variables in our model, we calculated the optimal migration speed ($U_{opt}$; m s^-1^) as the over-ground speed that minimized the ratio between migration costs and feeding season intake, resulting in the lowest percentage of annual energy intake being spent on a migration of a given distance:

$$
U_{\text{opt}} = min(\frac{E_{\text{mig}}}{E_{\text{feed}}}) \quad (7)
$$

## Statistical Analyses

All analyses were run in R (version 4.0.5) using the "stats" and "lme4" packages [@rcoreteam24]. linear regressions were coded as "ordinary-least-squares" regressions. Two-tailed t-tests were used to compare the mean migration distances and mean over-ground migration speeds between equatorward and poleward migration routes. Prior to conducting t-tests, we assessed normality using the Shapiro-Wilk test. Normality was confirmed for mean migration distance and mean over-ground migration speeds, so we proceeded with Welch’s two-tailed t-tests. Significance levels were set at $\alpha$ = 0.05 throughout our analyses. Average values are reported in a standard way (mean ±  SD), unless otherwise stated. The account for high variability in deployment count between migration routes in our satellite tag dataset, we averaged values at the level of the migration route (equatorward and poleward migrations were treated separately) and reported those values in our analyses, unless otherwise stated.

# Results

## Annual Energetic Cost of Migration

Recent studies on several mysticete species have produced high-resolution estimates of energetic intake and costs for both foraging and swimming by combining biologging tags with UAS-derived morphometrics and hydrodynamic physical modeling [@goldbogen_etal19; @savoca_etal21] (Figure 1). Using those estimates, we quantified the relationship between migration distance and the percentage of annual energetic intake devoted to migration costs (Figure 2). We found that these percentages increased at a faster rate for humpback whales (from a mean of `r format_numbers(mean(dataframe_humpback$EPercentMigrationFeed[dataframe_humpback$MigrationDistance_km == 2000], na.rm = TRUE), digits = 2, format = "dcml")` ± `r format_numbers(sd(dataframe_humpback$EPercentMigrationFeed[dataframe_humpback$MigrationDistance_km == 2000], na.rm = TRUE), digits = 2, format = "dcml")`% at 2,000 km to `r format_numbers(mean(dataframe_humpback$EPercentMigrationFeed[dataframe_humpback$MigrationDistance_km == 12000 & is.finite(dataframe_humpback$EPercentMigrationFeed)], na.rm = TRUE), digits = 2, format = "dcml")` ± `r format_numbers(sd(dataframe_humpback$EPercentMigrationFeed[dataframe_humpback$MigrationDistance_km == 12000 & is.finite(dataframe_humpback$EPercentMigrationFeed)], na.rm = TRUE), digits = 2, format = "dcml")`% at 12,000 km) than for blue whales (from a mean of `r format_numbers(mean(dataframe_blue$EPercentMigrationFeed[dataframe_blue$MigrationDistance_km == 2000], na.rm = TRUE), digits = 2, format = "dcml")` ± `r format_numbers(sd(dataframe_blue$EPercentMigrationFeed[dataframe_blue$MigrationDistance_km == 2000], na.rm = TRUE), digits = 2, format = "dcml")`% at 2,000 km to `r format_numbers(mean(dataframe_blue$EPercentMigrationFeed[dataframe_blue$MigrationDistance_km == 12000 & is.finite(dataframe_blue$EPercentMigrationFeed)], na.rm = TRUE), digits = 2, format = "dcml")` ± `r format_numbers(sd(dataframe_blue$EPercentMigrationFeed[dataframe_blue$MigrationDistance_km == 12000 & is.finite(dataframe_blue$EPercentMigrationFeed)], na.rm = TRUE), digits = 2, format = "dcml")`% at 12,000 km).

From our satellite tag dataset, we found the combined 95th percentile of unidirectional migration distances to be `r format_numbers(quantile(MigrationDistancesLit$Migration_Distance_km, 0.95), digits = 4, format = "dcml")` km, a distance that would result in migration costing ~10% of annual energy intake for both species. Mean migration distances of `r format_numbers(mean(MigrationDistancesLit$Migration_Distance_km[MigrationDistancesLit$Species == "Humpback"]), digits = 4, format = "dcml")` ± `r format_numbers(sd(MigrationDistancesLit$Migration_Distance_km[MigrationDistancesLit$Species == "Humpback"]), digits = 4, format = "dcml")` km for humpback and `r format_numbers(mean(MigrationDistancesLit$Migration_Distance_km[MigrationDistancesLit$Species == "Blue"]), digits = 4, format = "dcml")` ± `r format_numbers(sd(MigrationDistancesLit$Migration_Distance_km[MigrationDistancesLit$Species == "Blue"]), digits = 4, format = "dcml")` km for blue whales correlated with lower migration costs (~5% of annual intake).

![Figure 2. Relationship between annual migration distance covered and the percentage of annual energy used for migration. Vertical lines along the x-axis denote annual migration distances (D~mig~*2) for each individual humpback (orange) and blue (blue) whale obtained through satellite tagging and detailed in Table S1. The vertical dotted line denotes the 95th percentile for the probability densities combined (`r format_numbers(quantile(MigrationDistancesLit$Migration_Distance_km, 0.95), digits = 4, format = "dcml")` km).](./figs/MigrationPercentagesNew.png)

## Optimal Over-Ground Migration Speeds

We found a concave relationship between the migration speed of an individual (over-ground) and the ratio of net foraging season energy intake to migration energy loss (Figure 3). Each curve displays a single migration speed at which the energetic ratio of cost:benefit was minimized, representing an optimal migration speed. These optimal migration speeds fell between `r format_numbers(Opt_Speeds$OptSpeed[Opt_Speeds$MigrationDistance_km == 2000], digits = 3, format = "dcml")`-`r format_numbers(Opt_Speeds$OptSpeed[Opt_Speeds$MigrationDistance_km == 12000], digits = 3, format = "dcml")` m s^-1^ across our range of migration distances (2,000-12,000 km), with longer migration distances correlated with faster optimal migration speeds and an increased ratio of migration costs to annual energy intake. Longer migration distances also correlated with a higher percentage of the annual cycle (in days) devoted to migration at optimal migration speeds (ranging from `r format_numbers((mean(dataframe_combined$MigratoryDays[dataframe_combined$MigrationDistance_km == 2000], na.rm = TRUE)/365*100), digits = 2, format = "dcml")`% or `r format_numbers(mean(dataframe_combined$MigratoryDays[dataframe_combined$MigrationDistance_km == 2000], na.rm = TRUE), digits = 2, format = "dcml")` days for a 2,000 km migration to `r format_numbers((mean(dataframe_combined$MigratoryDays[dataframe_combined$MigrationDistance_km == 12000], na.rm = TRUE)/365*100), digits = 2, format = "dcml")`% or `r format_numbers(mean(dataframe_combined$MigratoryDays[dataframe_combined$MigrationDistance_km == 12000], na.rm = TRUE), digits = 2, format = "dcml")` days for a 12,000 km migration).

![Figure 3. Relationship between over-ground migration speed and the energetic ratio between annual migration costs and annual foraging season energy intake. Curves are given for a range of unidirectional migration distances (2,000-12,000 km). Vertical segments denote the migration speeds that minimize each curve. Dashed vertical lines denote the converted values of routine swimming speed that minimize cost-of-transport for each species in our analysis. Pie charts correspond to the percentages of the annual cycle (in days) devoted to foraging (blue), migration (orange), and breeding (light grey).](./figs/SpeedCurvesNew.png)

The average over-ground migration speeds for blue whales taken from our satellite tag dataset (`r format_numbers(mean(MigrationDistancesLit$Migration_Speed_m_s[MigrationDistancesLit$Species == "Blue"], na.rm = TRUE), digits = 3, format = "dcml")` ± `r format_numbers(sd(MigrationDistancesLit$Migration_Speed_m_s[MigrationDistancesLit$Species == "Blue"], na.rm = TRUE), digits = 3, format = "dcml")` m s^-1^) aligned closely with our predicted optimal migration speed for a 4,000 km migration distance (`r format_numbers(Opt_Speeds$OptSpeed[Opt_Speeds$MigrationDistance_km == 4000], digits = 3, format = "dcml")` m s^-1^), a distance very close to their average migration distance (`r format_numbers(mean(MigrationDistancesLit$Migration_Distance_km[MigrationDistancesLit$Species == "Blue"], 0.95), digits = 4, format = "dcml")` km). Average over-ground migration speeds for humpback whales (`r format_numbers(mean(MigrationDistancesLit$Migration_Speed_m_s[MigrationDistancesLit$Species == "Humpback"], na.rm = TRUE), digits = 3, format = "dcml")` ± `r format_numbers(sd(MigrationDistancesLit$Migration_Speed_m_s[MigrationDistancesLit$Species == "Humpback"], na.rm = TRUE), digits = 3, format = "dcml")` m s^-1^) were higher, aligning closely with the optimal migration speed for a 8,000 km migration (`r format_numbers(Opt_Speeds$OptSpeed[Opt_Speeds$MigrationDistance_km == 8000], digits = 3, format = "dcml")` m s^-1^), while their average migration distance (`r format_numbers(mean(MigrationDistancesLit$Migration_Distance_km[MigrationDistancesLit$Species == "Humpback"], 0.95), digits = 4, format = "dcml")` km) would suggest a speed closer to the optimal speed for our 6,000 km curve (`r format_numbers(Opt_Speeds$OptSpeed[Opt_Speeds$MigrationDistance_km == 6000], digits = 3, format = "dcml")` m s^-1^). At distances near the middle of our range (\~6,000 km), optimal migration speeds were similar to the routine swimming speed that minimizes cost-of-transport (\~2.50 m s^-1^ instantaneous forward speed or \~1.25 m s^-1^ over-ground speed) [@gough_etal19; @gough_etal21].

We compared our modeled relationship between migration distance and optimal migration speed against our full satellite tag dataset (n = `r format(as.numeric(nrow(MigrationDistancesLitAvgs), digits = 2))` migration routes) and found a similar increasing relationship between migration distance and migration speed (Figure 4; F = `r format_numbers(ModelCompareStats$statistic, digits = 3, format = "dcml")` and p = `r format_numbers(ModelCompareStats$p.value, digits = 2, format = "dcml")` for a comparison of the two models, suggestion no significant differences). Migration direction (equatorward vs. poleward) did not impact this relationship and we found that migration distances and migration speeds did not differ between the two directions (p = `r format_numbers(t_test_DistanceStats$p.value, digits = 2, format = "dcml")` for distance; p = `r format_numbers(t_test_SpeedStats$p.value, digits = 2, format = "dcml")` for speed).

![Figure 4. Relationship between migration distance and over-ground migration speed for satellite tracks obtained from literature sources. Filled symbols denote average values for a given migration route, with the size of symbols corresponding to the number of tag deployments averaged together from that migration route. Unfilled symbols correspond to individual satellite track data included in the migration route averages. Circles and squares denote equatorward and poleward migration routes, respectively. The dashed gray line denotes the relationship for these symbols, while the solid black line denotes the relationship between migration distance and optimal migration speed taken from our model shown in Figure 3.](./figs/DistanceVersusSpeedNew.png)

# Discussion

Our results are the first to show that a group of ocean-going, long-distance migratory species optimize their travel speeds for energetic efficiency across a range of migration distances. These optimal migration speeds result from a tradeoff between phenological constraints and swimming costs. If whales swim slower than the optimal migration speed (cost-minimizing), then the late arrival to the foraging grounds reduces foraging opportunities and energy intake. Conversely, whales that swim faster than the optimal migration speed (time-minimizing) incur locomotor costs greater than the energy gained from additional foraging days. In keeping with optimal migration theory [@alerstam_lindstrom90], our model predicted an intermediate solution for each migration distance that optimized the cost:benefit ratio between migration swimming costs and foraging season energy intake.

Previous research on migrating mysticetes found an energetic tradeoff within the migration route, with faster migrations incurring higher swimming costs but lower metabolic costs over a shorter period of time, leading to near-parity in energetic costs between short- and long-distance migrations [@riekkola_etal20]. Our results suggest that, even at optimal migration speeds, longer migrations incur higher costs when we factor in the broader annual cycle (Figures 3-4). From this purely energetic standpoint, the optimal life-history strategy would be to reduce migration costs to zero and remain in one place throughout the year, strongly suggesting that the fitness benefits of migration must outweigh the energetic costs in mysticetes.

Migration offers diverse fitness benefits, from predator and parasite avoidance to better mate selection or the maximization of energy intake at another location or point in the year [@avgar_etal14; @braithwaite_etal15; @pelletier_etal20]. For species that track shifting food sources [@aikens_etal20], migration increases energetic intake. For large mysticetes that leave their prey-rich foraging grounds in the winter, migration may have evolved to accelerate development or avoid predation. Warmer waters at low latitudes may allow for faster calf growth rates if they can reallocate energy from thermoregulation to growth [@clapham01; @rasmussen_etal07]. Predators, specifically killer whales (*Orcinus orca*), frequently attack calves and are more abundant at high latitudes [@corkeron_connor99; @mehta_etal07; @pitman_etal15]. Thus the fitness benefits of mysticete migration are derived from faster growth and reduced mortality of offspring, which likely outweigh the fitness costs associated with adult energy expenditure.

Mysticetes are thought to have established long-distance migration patterns and experienced rapid gigantism in the last \~5 million years due to a phase shift in ocean ecosystems towards stronger seasonality [@slater_etal17; @taylor_etal19]. The high foraging efficiencies that resulted from this shift likely allowed for rapid mass-specific calf development and growth with subsequently shorter, less costly breeding season intervals [@fortune_etal12; @oftedal97; @read_harvey89; @sibly_brown07]. Large body sizes also result in low mass-specific transport costs and large energy reserves, resulting in lower migration costs and an increased ability to support a capital breeding lifestyle [@oftedal00; @williams18].

This suite of evolutionary adaptations has allowed mysticetes to remain successful for the last \~5 million years, but this fast pace of life is dependent on abundant and predictable prey resources. Anthropogenic impacts on modern oceans (i.e., climate change, pollution, overfishing, ocean noise) have begun to impact the reliability, quality, and geographic location of prey species, possibly resulting in longer and more costly migrations [@agrelo_etal21; @gremillet_descamps23; @gulland_etal22; @hazen_etal13; @meyer-gutbrod_etal23; @nelms_etal21; @robinson_etal09; @szesciorka_stafford23]. The majority of whales in our analysis migrated less than \~9,000 km (unidirectionally) in a year, thereby keeping energetic costs low (<10% of annual budget; Figure 2). But in the shifting prey scenarios outlined for future oceans, an increase of 1,000-2,000 km could increase the cost of migration by as much as 3-4%, a significant burden that may have adverse ecological implications for species operating close to their energetic capacities. Villegas-Amtmann et al. [@villegas-amtmann_etal15; @villegas-amtmann_etal17] found that for the gray whale, a foraging season intake reduction of as little as 4% could result in a suspension of pregnancy. Pallin et al. [@pallin_etal23] similarly found that reproduction of humpback whales in the Antarctic is prey-limited, with pregnancy rates negatively impacted by declines in the abundance of krill. Mysticetes have shown resilience to predictable fluctuations in their environment and they can vary the timing and duration of foraging, migration, and breeding to account for these natural variations [@avila_etal20; @irvine_etal14; @oestreich_etal22; @russell_etal22; @szesciorka_etal20]. Unexpected or cumulative disturbances, on the other hand, can cause direct impacts on the foraging success of mysticetes [@pirotta_etal18; @pirotta_etal19].

These habitat uncertainties call into question whether life history strategies that include long-distance migrations will remain profitable into the future, or whether shorter distance or non-migratory strategies such as those seen in equatorial mysticete populations will become more common [@best01; @geijer_etal16; @iwata_etal17; @izadi_etal22; @minton_etal15]. In any event, mysticetes' ability to optimize their travel speeds for energetic efficiency across migration distances undoubtedly increases their fitness, underpinning their evolutionary success.

# Supplemental Information

```{r Literature Review Data, echo=FALSE}
LitDataForTable <- MigrationDistancesLit %>% 
  subset(select = c(Species, Source, Migratory_Route_Simple, Direction_of_Travel, Migration_Distance_km, Migration_Duration_days, Migration_Speed_m_s)) %>% 
  rename('Species' = 'Species',
         'Data Source' = 'Source',
         'Migration Route' = 'Migratory_Route_Simple',
         'Direction' = 'Direction_of_Travel',
         'Distance' = 'Migration_Distance_km',
         'Duration' = 'Migration_Duration_days',
         'Speed' = 'Migration_Speed_m_s')

kable(LitDataForTable, digits = 2, 'pipe',
      caption = "Table S1. Metadata for satellite tag-derived migration tracks obtained from a review of literature. Routes are defined by their general geographic starting and ending positions.")
```

```{r Energetic Model Variables Table, echo=FALSE}
load("data/EnergyModelVariables.rda")

EMVariablesForTable <- EnergyModelVariables %>% 
  subset(select = c(Variable, Symbol, Blue_Values, Humpback_Values)) %>% 
  rename('Variable' = 'Variable',
         'Symbol' = 'Symbol',
         'Blue Values' = 'Blue_Values',
         'Humpback Values' = 'Humpback_Values')

kable(EMVariablesForTable, digits = 2, 'pipe',
      caption = "Table S2. Variables and associated symbols related to energetic modeling, ordered as they appear in the text. Selected values are given for blue and humpback whales.")
```

# Author Contributions

Conceptualization - W.T.G, M.F.C, M.S.S., W.K.O., E.L.H., L.B., J.A.G.; Data Curation - W.T.G., D.M.P.; Formal Analysis - W.T.G., J.F.; Methodology - W.T.G., M.F.C., E.L.H., J.F., J.A.G.; Visualization - W.T.G, M.F.C, J.A.G.; Resources - D.M.P., J.F., J.C.; Funding Aquisition - L.B., J.A.G.; Writing - Original Draft - W.T.G.; Writing - Review and Editing - all authors

# Acknowledgements

W.T.G. was financially supported by the Office of Naval Research (ONR) (N000141912455; N000142212721) and the United States Pacific Fleet (FLEET) (N62470-20-D0016) during the development of this work. We would like to thank the members of the Marine Mammal Research Program at the University of Hawaii at Manoa, the members of the Goldbogen Lab at Stanford University's Hopkins Marine Station, and Dr. Frank Fish (West Chester University of Pennsylvania) for their support and advice on the figures and writing.

# Declaration of Interests

The authors declare no competing interests.

# References
